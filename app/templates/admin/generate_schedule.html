<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate Schedule</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/generate_schedule.css') }}" />
</head>

<body>
  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  <div id="flash-messages">
    {% for category, message in messages %}
    <div class="flash-message {{ category }}">{{ message }}</div>
    {% endfor %}
  </div>
  {% endif %}
  {% endwith %}

  <h1>Generate Nurse Schedule</h1>

  <!-- Form for Constraints -->
  <form action="{{ url_for('admin.generate_schedule') }}" method="POST">
    <label for="category_filter">Category:</label>
    <select name="category_filter" id="category_filter" required>
      <option value="Senior">Senior</option>
      <option value="Junior">Junior</option>
      <option value="Head">Head</option>
    </select>
    <br><br>

    <label for="num_nurses_per_shift">Number of Nurses per Shift:</label>
    <input type="number" name="num_nurses_per_shift" id="num_nurses_per_shift" required>
    <br><br>

    <!-- Maximum Days per Week Constraint -->
    <label for="max_days_per_week">Maximum Days per Week:</label>
    <input type="number" name="max_days_per_week" id="max_days_per_week" required>
    <br><br>

    <!-- Shift Preference (Optional) -->
    <label for="shift_preference">Shift Preference (Optional):</label>
    <select name="shift_preference" id="shift_preference">
      <option value="Any">Any</option>
      <option value="Morning">Morning (08:00 AM - 04:00 PM)</option>
      <option value="Afternoon">Afternoon (04:00 PM - 12:00 AM)</option>
      <option value="Night">Night (12:00 AM - 08:00 AM)</option>
    </select>
    <br><br>

    <!-- Shift Times -->
    <label for="shift_time">Select Shift Times:</label><br>
    <input type="checkbox" name="shift_time" value="08:00:00"> 08:00 AM - 04:00 PM<br>
    <input type="checkbox" name="shift_time" value="16:00:00"> 04:00 PM - 12:00 AM<br>
    <input type="checkbox" name="shift_time" value="00:00:00"> 12:00 AM - 08:00 AM<br><br>

    <button type="submit">Generate Schedule</button>
  </form>

  <!-- Display Generated Schedule -->
  {% if schedule %}
  <h2>Generated Schedule</h2>

  <!-- Weekly Schedule Display -->
  <div class="weekly-schedule">
    {% for shift in ['08:00:00', '16:00:00', '00:00:00'] %}
    <h3>
      {% if shift == '08:00:00' %} Morning Shift
      {% elif shift == '16:00:00' %} Afternoon Shift
      {% else %} Night Shift
      {% endif %}
    </h3>
    <table border="1">
      <thead>
        <tr>
          <th>Nurse Name</th>
          <th>Monday</th>
          <th>Tuesday</th>
          <th>Wednesday</th>
          <th>Thursday</th>
          <th>Friday</th>
          <th>Saturday</th>
          <th>Sunday</th>
        </tr>
      </thead>
      <tbody>
        {% for s in schedule %}
        {% if s[3] == shift %}
        <tr>
          <td>{{ s[1] }}</td>
          <td>{{ s[2] == 'Monday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Tuesday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Wednesday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Thursday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Friday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Saturday' and 'Scheduled' or '' }}</td>
          <td>{{ s[2] == 'Sunday' and 'Scheduled' or '' }}</td>
        </tr>
        {% endif %}
        {% endfor %}
      </tbody>
    </table>
    {% endfor %}
  </div>

  {% endif %}
</body>

</html>